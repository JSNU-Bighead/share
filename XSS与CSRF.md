# 引言
关于web领域的安全问题，在v-html时候开始接触，因为一直做的都是内部系统且都是内网访问，安全性并没有过多在意。最近做了项目需要外网访问，
考虑到安全性针对性的去看了下关于常见的XSS和CSRF攻击方式。
# XSS (Cross Site Script) 跨站脚本攻击 
指的是攻击者在网站注入恶意的客户端代码（js,html,flash），来篡改网页，控制浏览器，获取用户的隐私数据。
## 反射型（非持久性）
反射型 XSS 只是简单地把用户输入的数据 “反射” 给浏览器。
这种攻击方式往往需要攻击者诱使用户点击一个恶意链接，或者提交一个表单，或者进入一个恶意网站时，注入脚本进入被攻击者的网站。
例如：提交数据后，返回一段js将整个页面内容删除等操作。
## 存储型
存储型 XSS 会把用户输入的数据 “存储” 在服务器端，当浏览器请求数据时，脚本从服务器上传回并执行。这种 XSS 攻击具有很强的稳定性。
例如：攻击者在社区或论坛上写下一篇包含恶意 JavaScript 代码的文章或评论，文章或评论发表后，所有访问该文章或评论的用户，
都会在他们的浏览器中执行这段恶意的 JavaScript 代码。
## 基于DOM
恶意脚本修改页面的 DOM 结构，是纯粹发生在客户端的攻击。
## 防范
### CSP (Content Security Policy) 内容安全策略 
主流浏览器内置的防范XSS的措施。但是会影响eval函数执行，内嵌js执行，只能通过白名单加载远程脚本。
### HttpOnly 防止劫取 Cookie。
禁止页面的Javascript 访问带有 HttpOnly 属性的Cookie。
### 输入检查
输入检查一般是检查用户输入的数据中是否包含 <，> 等特殊字符，如果存在，则对特殊字符进行过滤或编码，传递给服务器。
### 输出检查
与输入检查类似，用户输入的不安全，服务器返回的也比一定安全，过滤或编码后输到页面。
# CSRF (Cross Site Request Forgery) 跨站请求伪造
指的是攻击者借助受害者的 Cookie 骗取服务器的信任，可以在受害者毫不知情的情况下以受害者名义伪造请求发送给受攻击服务器，
从而在并未授权的情况下执行在权限保护之下的操作。
## 防范
### 验证码
CSRF 攻击往往是在用户不知情的情况下构造了网络请求。而验证码会强制用户必须与应用进行交互，才能完成最终请求能够很好地遏制 CSRF 攻击。
但是处于用户考虑，不可能每个请求都去加验证，所以作为最简洁而优先的方式，只能作为一种辅助手段，而不是主要手段。
### Referer Check
在 HTTP 头中有一个字段叫 Referer，它记录了该 HTTP 请求的来源地址。通过 Referer Check，可以检查请求是否来自合法的”源”。
### 添加token
要抵御 CSRF，关键在于在请求中放入攻击者所不能伪造的信息，并且该信息不存在于 Cookie 之中。可以在 HTTP 请求中以参数的形式加入一个随机产生的 token，
并在服务器端建立一个拦截器来验证这个 token，如果请求中没有 token 或者 token 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求
#总结
主要总结了 XSS 和 CSRF 的攻击原理和防御措施。当然，在 Web 安全领域，除了这两种常见的攻击方式，也存在这 SQL 注入等其它攻击方式，
最后，总结一下 XSS 攻击和 CSRF 攻击的常见防御措施：
防御 XSS 攻击: 1.HttpOnly 防止劫取 Cookie 2.用户的输入检查 3.服务端的输出检查
防御 CSRF 攻击: 1.验证码 2.Referer Check 3.Token 验证
